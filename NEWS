Click NEWS

Version 1.3pre1   5.Mar.2003

* Incompatible changes

** The 'Queue' element is now a NotifierQueue. To access a queue without
   notification, use 'SimpleQueue'.

** The semantics of IPFilter 'deny' arguments have changed. Now, 'deny'
   means the same thing as 'drop'. The old behavior was inappropriately
   surprising.

** Deprecated KernelTap element in favor of KernelTun.

** Renamed MergeByTimestamp to TimeSortedSched.

** '--enable-clickfs' is the default. (Clickfs provides a symlink from
   /proc/click to /click to make upgrading easier.)

** Removed elements deprecated in 1.2.4. This includes LookupIPRoute,
   LookupIPRouteLinux, FromLinux, ToLinux, ToLinuxSniffers, PeekHandlers,
   ProbSplitter, and RandomLossage.

** Removed user-level Click driver's '--stop' option.

** The 'void Element::run_scheduled()' method has been deprecated; use
   'bool Element::run_task()' or 'void Element::run_timer()' instead.
   'run_task()'s bool return value should be true iff the task managed to
   do some useful work. (This helps the adaptive scheduler.)

** HandlerCall's interface has changed. So have the raw functions for
   accessing handlers from a Router object.

** Element map files now use an XML format, and are called 'elementmap.xml'
   and 'elementmap-PACKAGE.xml', not 'elementmap' and 'elementmap.PACKAGE'.

** LLRPCs now explicitly encode the amount of data they transfer to and
   from the caller, using the same mechanism as ioctl(). The local_llrpc()
   virtual method has been removed.

** Removed deprecated header files like <click/click_ip.h> (use
   <clicknet/ip.h> and similar).

** Changed ICMP structure and macro names in <clicknet/icmp.h>.

** Removed deprecated Element methods and method signatures, including
   'Element::uninitialize()', 'Element::configure(const Vector<String> &)',
   and 'Element::live_reconfigure(const Vector<String> &)'.

** Click declarations and definitions are now surrounded with CLICK_DECLS
   and CLICK_ENDDECLS macros (see any source file for an example). These
   macros normally do nothing. In the 'ns' driver, though, they drop all
   Click declarations into a separate namespace.

** Removed 'String::operator const char *()', which caused problems with
   newer GCCs.

* Drivers

** Add an optional adaptive task scheduler, written initially by Petros
   Zerfos <pzerfos@cs.ucla.edu>. Give 'configure' the '--enable-adaptive'
   option to turn it on. The adaptive scheduler takes less CPU time when
   Click isn't busy, and lets you control the minimum and maximum shares
   that Click will take of the CPU. This is particularly useful for the
   Linux kernel module, on a uniprocessor, for running user-level programs
   (tcpdump, for instance) as well as Click. The adaptive scheduler
   provides access to its parameters via handlers; see click.o(8) for more
   information.

** Integrated the 'nsclick' driver from the University of Colorado, and
   particularly by Michael Neufeld. This driver lets you integrate a Click
   router with an ns simulation; Click can accept ns packets and return
   packets to ns. See configure's '--enable-ns' option and the 'ns'
   subdirectory.

** Add support for Linux 2.4.20 and a newer Intel E1000 driver (4.3.15).

** Linux kernel module driver notices when other processes are waiting to
   access the task list (to unschedule a task, for example), and explicitly
   waits to give them a chance.

** Various Linux kernel module bug fixes, including a serious one in the
   SKB manager (mismeasured packet sizes could cause a kernel crash
   eventually).

** Add 'Task::strong_unschedule()', which moves tasks to the quiescent
   thread; that way, tasks will not run even if they are rescheduled.
   Useful in the presence of notification.

** Improve performance of add_select() and remove_select() at user level.

* Elements

** Add SetUDPChecksum, TimestampAccum, PaintSwitch, KernelTun, MixedQueue.

** Add a set of elements for trace analysis via a new packet annotation,
   the aggregate annotation. Elements include AggregateIPFlows,
   ToIPFlowDumps, AggregateIP, AggregateLength, AggregateCounter,
   AggregateFilter, AggregateFirst, AggregateLast.

** Added notification support to ToDevice, DelayUnqueue, Unqueue,
   ToIPSummaryDump, ToDump.

** FromIPSummaryDump and ToIPSummaryDump: Add optional binary format to
   save space and speed processing. Add 'aggregate', 'tcp_opt', 'tcp_sack',
   'tcp_window', 'first_timestamp', and 'ip_opt' content types.
   FromIPSummaryDump understands '!flowid' and '!aggregate' lines.

** FromDump and friends support 802.11 link types and the IPv6 Ethernet type.

** Extended or changed functionality for ToDump (optional output port),
   Counter (different keyword argument names), CycleCountAccum and
   PerfCountAccum (different handler names), ControlSocket (different
   select() plan for writes reduces needless spinning; READONLY is a
   keyword argument), DelayUnqueue (supports combination of long delays and
   fast rates), IPFragmenter (HONOR_DF is a keyword argument), SetIPAddress
   (supports live reconfiguration), UDPIPEncap (supports live
   reconfiguration), IPGWOptions (lazy packet copying and better behavior
   on bad options), ICMPError (accept mnemonic names for ICMP error types
   and codes), IPReassembler (optionally emit dead fragments to output 1).

** Bug fixes to FromIPSummaryDump, ToIPSummaryDump, IPReassembler,
   FromDump, ICMPRewriter, ICMPPingRewriter, ProgressBar, TCPRewriter,
   AddressInfo, ARPResponder, ToHost, ToHostSniffers, Classifier,
   InfiniteSource, IPGWOptions, ICMPError, IPOutputCombo, SetTCPChecksum.

* Tools

** Add click2xml tool, for translating a Click configuration into an XML
   format, and a preliminary version of xml2click, which goes the other
   way.

** Changed meaning of click-mkmindriver's `-e' option. Now `-e' means
   `--expression' for consistency. `-E' means `--elements'.

** click-install supports the BSD kernel module.

** Bug fixes to click-devirtualize, click-install, click-xform,
   click-buildtool.

* Internals

** Add 'typename' where required to support newer GCCs.

** Add Packet::shrink_data(), Packet::icmp_header(), and some others.

** Change interface to BigHashMap iterators and BigHashMap_Arenas.

** At user-level, ErrorHandler supports '%[efgEFG]' conversions for
   doubles. To print an element declaration, say '%{element}' (not '%e').

** Bug fixes to CLP, BigHashMap, ...

** Compiles cleanly on machines with 64-bit longs.

* Acknowledgements

** Thanks to AUTHORS, and (in no particular order) to YongKang Zhu, Filip
   Henderieckx, Vlemincx Koen, David Scott Page, Wang Po-Cheng, Adam Smith,
   Ryan Menezes, Gordon Lee, Chip Coldwell, Xiao Phong, Jose Vasconcellos,
   Tomasz Jaskolski, Bart Samwel, and anyone we've missed.


Version 1.2.4   21.May.2002

* Drivers

** FreeBSD module updates from Luigi Rizzo.

** The Linux kernel module can support its own /proc-like file system,
   "clickfs". This file system is faster and takes less memory than the
   default /proc/click filesystem, and it is not subject to arbitrary
   limits on the number of files. Generally you will mount it under /click.
   (Click-install takes care of file system mounting and unmounting.) Give
   ./configure the --enable-clickfs option to enable clickfs (and disable
   /proc/click). Currently, clickfs only works under Linux 2.2. In the next
   release, it will also work under Linux 2.4, and --enable-clickfs will be
   the default.

** Fix several race conditions in the Linux kernel module.

** The user-level driver works on Solaris. Thanks to David Scott Page
   <page@cs.utexas.edu> for patches and suggestions.

* Elements

** Add notifier support. The NotifierQueue element acts like a Queue, but
   can reschedule downstream Tasks when packets arrive on a previously
   empty Queue. This can greatly reduce CPU usage. Several other elements
   listen for notification, including DelayUnqueue, Discard, and ToDevice.

** Rename FromLinux, ToLinux, and ToLinuxSniffers to FromHost, ToHost, and
   ToHostSniffers. The old names are still available.

** Classifier optimization algorithm changed. The new algorithm, based on
   dominators, is much faster for medium-to-large Classifiers.

** Add FromDAGDump element in the analysis package. This element reads DAG
   dumps (see http://dag.cs.waikato.ac.nz/).

** Add LinearIPLookup element, a version of StaticIPLookup that supports
   dynamically adding and removing routes.

** Add SortedIPLookup element, a version of LinearIPLookup that sorts its
   routes.

** Bug fixes and enhancements in AddressInfo, CheckIPHeader, DelayUnqueue,
   DriverManager, Linux FromDevice, FromDump, FromIPSummaryDump,
   FrontDropQueue, Grid elements, ICMPPingResponder, ICMPSendPings,
   IPAddrRewriter, IPFragmenter, IPPrint, IPReassembler, IPRewriter,
   IPRouteTable, RadixIPLookup, TCPRewriter, TimeFilter, ToIPSummaryDump,
   etc.

** Add RandomSwitch element.

** Add preliminary elements that support regression testing, in
   elements/test.

* Tools

** Add click-pretty tool, which pretty-prints Click configuration files as
   HTML.

** Click-install works for the FreeBSD kernel module.

** Click-install exits with nonzero exit status if the configuration could
   not be initialized.

* Internals

** The signatures for the `Element::configure()' and
   `Element::live_reconfigure()' methods have changed. Formerly, these
   methods took a `const Vector<String> &conf'. Now, they take a
   `Vector<String> &conf', and the methods may alter the `conf' argument
   however they'd like. The old signatures still work for backward
   compatibility, but they are deprecated, and will be removed in a future
   release.

** Deprecated `Element::uninitialize()' in favor of a new method,
   `Element::cleanup(CleanupStage stage)'. The `stage' argument, an
   enumerated value, says how far the element was initialized: not at all
   (CLEANUP_NO_ROUTER), configure() failed (CLEANUP_CONFIGURE_FAILED),
   configure() succeeded but initialize() was not called
   (CLEANUP_CONFIGURED), initialize() failed (CLEANUP_INITIALIZE_FAILED),
   initialize() succeeded but the router as a whole failed
   (CLEANUP_INITIALIZED), and the router initialized successfully,
   including this element (CLEANUP_ROUTER_INITIALIZED). So `uninitialize()'
   corresponded to `stage >= CLEANUP_INITIALIZED'.
   `Element::uninitialize()' works for now, but it will be removed in a
   future release.

** The signature for the `Element::configuration()' method has also changed.
   It no longer takes a `bool *' argument.

** Add cp_va_parse_remove_keywords() function, which removes keywords from
   an argument list.

** Moved network-header-structure #include files to include/clicknet. For
   instance, `#include <click/click_ip.h>' should now be written `#include
   <clicknet/ip.h>'. The old names still work, but will be removed in a
   future release.

** Renamed `IPAddress::mask_more_specific()' method to
   `IPAddress::mask_as_specific()', to emphasize that it allows equality.

** Changed click_ip6 header structure.

** Tools substantially rewritten. The tool library is now much easier to
   deal with, so tools should be easier to write, debug, and understand.

** Better handling of out-of-memory events.

** Improved `Packet::uniqueify()' implementation: it now copies only the
   packet data, not both header and data.

** Click identifiers can no longer end with a slash.

* Acknowledgements

** Thanks to the usual suspects (AUTHORS), and to David Scott Page
   <page@cs.utexas.edu>, Luigi Rizzo <rizzo@aciri.org>, Eric Freudenthal
   <eric.freudenthal@nyu.edu> and Tao Zhao <taozhao@cs.nyu.edu>, and Jose
   Vasconcellos <jvasco@bellatlantic.net>.


Version 1.2.3   4.Dec.2001

* Drivers

** Linux kernel module: Rename Click kernel threads to "kclick".

** User-level driver: Add `-e' option.

** Various Linux 2.4 improvements.

** FreeBSD driver is coming along nicely. You should compile this version
   of the driver against an *unmodified* FreeBSD kernel (RELENG_4 branch,
   version 440002 or later). Thanks to Luigi Rizzo, some of the
   improvements in the Click kernel patch have been checked in to the
   latest FreeBSD source! Bug fixes: can handle chained mbufs, etc.

** Better support for cross-compiling tools, via the `--enable-tools'
   configuration switch.

** Linux kernel module: Bug fixes, from Mazu, for dynamic installation and
   removal of devices, and for receiving large packets.

* Elements

** Added a collection of analysis-related elements; give
   `--enable-analysis' to ./configure. Elements include FromIPSummaryDump
   and ToIPSummaryDump (read and write ASCII summary files; see
   http://www.aciri.org/kohler/ipsumdump/), FromNetFlowSummaryDump (read
   ASCII NetFlow summary files), AnonymizeIPAddr (anonymize IP addresses
   while preserving prefixes), MergeByTimestamp (merge multiple time-sorted
   packet streams into a single time-sorted stream), TimeFilter (select
   packets by timestamp), and TimeRange (monitors packet timestamps).

** New elements: StripToNetworkHeader, ProgressBar (prints an ultra-cool
   progress bar to standard error), etc.

** CheckIPHeader and friends set the destination IP address annotation from
   the IP header's destination address.

** IPClassifier/IPFilter supports more >/>=/</<= comparisons, and gives
   better error messages on comparisons it does not support.

** RED handles long quiescent periods better. As a result, Queue and
   friends could remove their annoying _empty_jiffies member. Also, RED
   uses the Gentle variant recommended by the RED gods.

** Added AdaptiveRED element, by Jitendra Padhye <padhye@aciri.org>.

** FromDump can read from gzipped or bzipped tcpdump files.

** Deprecate RandomLossage and ProbSplitter elements in favor of new
   RandomSample element.

** Deprecate PeekHandlers in favor of PokeHandlers, whose syntax has been
   extended. The new PokeHandlers is incompatible with old PokeHandlers
   configuration strings.

** Bug fixes in ARPQuerier, FromDevice, ToDevice, FromDump,
   ICMPPingResponder, ControlSocket, DriverManager, IPRewriter and friends,
   Grid elements, Classifier.

** Added functionality to FromDevice, FromDump, Shaper, BandwidthShaper,
   PokeHandlers, DriverManager, Grid elements, Counter.

* Configuration parsing

** Configuration arguments that represent time can take suffixes like "h"
   for hours and "m" for minutes, as well as "s" for seconds, "ms" for
   milliseconds, and so forth.

** Bug fixes in cp_real unparsing.

** Add cp_double() and cpDouble, available only at user level.

** Fix static binding errors in configuration language. Also, configuration
   language supports `${VAR-DEFAULT}' variable reference syntax, which uses
   the text `DEFAULT' if `$VAR' is not set.

* General

** General configuration cleanup: Split config.h into multiple files to
   reduce needless recompilation; regularize symbols.

** Task improvements should make everything a bit more robust. For example,
   Task::unschedule() always unschedules the task right away; it grabs a
   lock.

* Grid

** New startup scripts for generating Grid configurations.

** New elements implement Grid-level route tracing and statistics:
   GridProbeSender, GridProbeHandler, and GridProbeReplyReceiver.

** Extended logging code in old Grid elements.

* Acknowledgements

** Thanks to the usual suspects (AUTHORS), and to Geir <kp13@gmx.co.uk>,
   Luigi Rizzo <rizzo@aciri.org>, and Atanu Ghosh <atanu@aciri.org>.


Version 1.2.2   1.Sep.2001

* General

** Added `etc/diagrams' directory, containing source code we use to
   generate Click diagrams.

** Added `etc/samplellrpc' directory, a simple program demonstrating how to
   poke a Linux kernel Click's LLRPC handlers with ioctl() calls.

** Added `etc/libclick' directory, which contains a self-sufficient
   distribution for building the Click user-level library.

** Add `--enable-warp9' configuration option, which loosens element
   specifications to enable high-speed tests. For example, with
   `--enable-warp9' on, PollDevice does not set timestamps on packets it
   receives.

** Add `--enable-greedy' configuration option, which prevents the Linux
   kernel driver from giving up the CPU. Use only if you have multiple
   CPUs. (Benjie Chen)

** Many bug fixes.

* Drivers

** Add preliminary support for a polling FreeBSD kernel driver!! (Nickolai
   B. Zeldovich)

** Add polling support for EEpro 100 devices (Nickolai B. Zeldovich), and
   improve polling support for Tulip and Acenic (Benjie Chen, Nickolai).

** Significantly more stable support for Linux 2.4, and update the kernel
   patch to Linux 2.4.9.

* Parsing

** Time arguments understand suffixes like "ms", for milliseconds, and
   "us", for microseconds. So you can say `1ms' or `2sec' or `5000usec'.

** Support IP prefix syntax like `192.111/16'. Requested by Vern Paxson
   <vern@aciri.org>.

* Elements

** FromDump is significantly faster, supports new keyword arguments, and
   can read Linux tcpdump files. Also, FromDump supports FDDI
   encapsulation.

** ToDump can write to standard output.

** Removed deprecated elements HashDemux, PullToPush, FromBPF, and ToBPF.

** Fix bugs in Linux kernel module device elements: avoid dereferencing
   null devices, and be careful about device reference counts for Linux
   2.4.

** Bug fixes to IPRewriter, TCPRewriter, Switch, PullSwitch, ....

** Added functionality to ControlSocket, RED, FromLinux, FromDump, ....

** Added SetPacketType, IPLookupRadix, ....

** Renamed LookupIPRoute to StaticIPLookup, LookupIPRoute2 to
   RadixIPLookup, and LookupIPRouteLinux to LinuxIPLookup. The old names
   are still available.

* Internal

** The format of `elements.conf' files has changed.

** The header files for ScheduleInfo, AddressInfo, AlignmentInfo, Error,
   and DriverManager are stored in `<include/click/standard>'. This makes
   it simpler to distribute a self-contained Click library.

** Bug fix: Elements are uninitialized and destroyed in the reverse order
   from which they were initialized. Reported by Kyle Jamieson
   <jamieson@mit.edu>.

** Made most Click configuration tests into Autoconf macros in
   `acclick.m4'. This file may be shared among "Click-like" packages.

** Check for byte order, and provide CLICK_BYTE_ORDER configuration
   constant.

** Add Packet::tcp_header() and Packet::udp_header() convenience functions.


Version 1.2.1   26.Jun.2001

* General

** Added preliminary support for Linux 2.4! The patch is in
   etc/linux-2.4.4-patch; it also applies to Linux 2.4.5. Click can receive
   and send packets, and there is preliminary support for polling, as well.
   We will be improving Linux 2.4's stability with time. Thanks to Nickolai
   B. Zeldovich.

** Many bug fixes, particularly to ARPResponder, ToLinux, LookupIPRoute,
   cp_unparse_real2, cpArguments.

** Updated etc/samplepackage to bring it up to date. It is a good starting
   point for building your own package.

* Elements

** In the kernel, FromDevice, PollDevice, and ToDevice watch for
   notifications when devices go up or down. Now you can remove a device
   that the Click configuration refers to; the relevant element will simply
   stop pushing or pulling packets. If you add the device back again, the
   relevant element will seamlessly attach to it. Also added the
   `ALLOW_NONEXISTENT' keyword argument to these elements.

** In the kernel, AddressInfo supports device names as Ethernet address
   shorthand. So you can say `EtherEncap(..., eth0, ...)' and it will use
   eth0's Ethernet address.

** Added KernelHandlerProxy element, and added the `PROXY' keyword argument
   to ControlSocket. Now you can use a ControlSocket to talk to a kernel
   configuration -- for example, with ClickController. Element donated by
   Mazu Networks, Inc.

** FromDump can read modified tcpdump files generated by Linux tcpdump.

** ICMPSendPings has more keyword arguments. ICMPPingResponder now sets the
   destination IP address annotation. ICMPRewriter can rewrite ping
   responses as well as TCP and UDP responses.

** Added DelayUnqueue, DelayShaper, and IP6Print elements.

* Tools

** Added click-flatten tool.

* C++ API changes

** Renamed `u_intXX_t' types to `uintXX_t'.

** Elements no longer need to `#include <click/package.hh>'.

** Added cpFilename confparse type at user level, which includes tilde
   expansion.

** `hashcode()', the function used by BigHashMap and HashMap to calculate
   hash values, is now an overloaded function, not a member function. See
   include/click/ipflowid.hh for an example.


Version 1.2.0   3.May.2001

* General

** Added support for Click multithreading: multiple processors processing
   packets through the Click configuration simultaneously. This required
   extensive source code changes and adding optional locks to several
   elements. Turn multithreading on at configure time with
   `--enable-multithread=[NTHREADS]'. Most elements in ip, standard, and
   linuxmodule are synchronized. SMP safe elements are marked with 
   ELEMENT_MT_SAFE(elementname) at the end of the .cc file. See
   http://www.pdos.lcs.mit.edu/papers/click:usenix01/ for a paper on SMP
   Click.
   
** Multithreading: User can use StaticThreadSched or SortedTaskSched elements
   to assign schedulable elements such as PollDevice and ToDevice to different
   threads. 
   
** Multithreading: Queue is not synchronized, but MSQueue and CPUQueue
   elements are SMP safe queue implementations. LookupIPRoute is not
   synchronized. Should use LookupIPRouteMP instead.

** Multithreading: ARPQuerier and IPRewriter have been synchronzied using
   spinlocks and readwrite locks.

** Added FastTCPFlows, FastUDPSrc, and FastUDPFlows elements. These elements
   can be used to generate test traffic.

** Added preliminary support for cross-compilation. Everyone loves Doug!!

** Many bug fixes, and being careful about out-of-memory situations.

** Added support for special Intel-only assembly instructions, which make
   things faster. Turn it on at configure time with `--enable-intel-cpu'.

* Kernel driver

** Changed device polling interface: sk_buff recycling moved out of
   individual device drivers and into Click (linuxmodule/skbmgr.cc). This
   requires a different 2.2.18 patch. You will need to apply the patch in
   this distribution and recompile.

** Added a polling Intel EEPro 1000 gigabit driver, which can receive or
   send up to 1.3 million 64 byte packets per second.

** Added `accessible' and `priority' module parameters (see
   click-install(1)'s `--private' and `--priority' options).

* Elements

** Kernel module device elements changed to use the new polling interface.
   See above.

** Added MarkIPCE element for ECN support.

** Added ECN syntax (`ip ect' and `ip ce') and `ip ttl' to IPFilter and
   IPClassifier.

** Added DriverManager element that says how to handle please_stop_driver()
   events.

** Added keyword arguments to Print, IPPrint, InfiniteSource, RatedSource,
   RED, TimedSource, ....

** Added ChatterSocket, DRRSched, PrintOld, PushNull, PullNull, and
   SetTimestamp elements.

** Real number parsing functions handle overflow and rounding better.

** IPRewriter garbage collection optimizations from Benjie.

** Added AddressTranslator, ProtocolTranslator46, ProtocolTranslator64
   elements that can translate between IPv6 networks and IPv4
   networks.

* Tools

** Added click-mkmindriver(1).

** click-align(1) and click-devirtualize(1) bug fixes.

** Add `-C CLICKPATH' argument to all relevant tools.

* C++ API changes

** Added preliminary programmer documentation in Texinfo format
   (doc/click.texi). Removed old Element and Connection man pages, which
   were obsolete.

** The Element class no longer inherents from `ElementLink'. Elements that
   wish to be scheduled must include and initialize a `Task' object.

** Changed TimerHook type to `void (*)(Timer *, void *)'.

** Added Element methods `flow_code' and `configuration'.

** Renamed `Element::Connection' class to `Element::Port'.

** Other changes.


Version 1.1   15.Dec.2000

* Element packages

** Added support for element packages. An element package is a group of
   elements that can be dynamically loaded into a driver. Required several
   changes described below.

** Rearranged include files. All include files formerly in `lib/' are now
   stored in `include/click/' instead. Do not say `#include "element.hh"'
   any more; say `#include <click/element.hh>' instead. Similar statements
   hold for `<click/packet.hh>', `<click/confparse.hh>', and many others.
   Check under include/click for a full list. Required for element package
   support.

** Every element should say `MOD_INC_USE_COUNT;' in its constructor and
   `MOD_DEC_USE_COUNT;' in its destructor. Required for element package
   support.

** Added a new directory, `etc/samplepackage', that demonstrates a simple
   element package. In particular, this shows how to write a Makefile for
   an element package.

* General

** Compound element semantics: Connecting to a compound element port whose
   corresponding `input' or `output' was not mentioned inside the compound
   element is now an error. Leaving a compound element input or output port
   unused is also an error.

** Compound element semantics: Added overloaded compound elements. A single
   compound element can have multiple definitions; Click uses the
   definition with matching numbers of arguments, input ports, and output
   ports. See click(5) for details.

** Restructured build tools: created `click-buildtool' and
   `click-mkelemmap'.

** Changed element documentation format: list of keywords follows `=s'. See
   elementdoc(7) for details.

** The `cp_va_parse' family of functions supports keyword arguments. Use
   cpKeywords, and see `elements/ip/ipprint.cc' for an example. Also
   supported: adding and removing argument types dynamically.

** Added support for generic annotations, such as "a one-byte annotation
   stored in generic annotation byte 13". Transitioned many existing packet
   annotations to macro wrappers for generic annotations; see
   `include/click/packet_anno.hh'. New structure is more easily extensible.

** Many other bug fixes and configuration fixes.

* Elements

** Added ICMPRewriter and ICMPPingRewriter for rewriting ICMP errors and
   ICMP pings, respectively.

** Reorganized ICMP elements into `elements/icmp' directory, and TCP/UDP
   elements into `elements/tcpudp' directory.

** IPRewriter and TCPRewriter quickly release completed TCP connections.

** Improved IPFilter parsing functions and added some new protocols.

** CheckIPHeader, CheckIPHeader2, CheckICMPHeader, CheckTCPHeader, and
   CheckUDPHeader can print more detailed information about why they are
   dropping packets.

** Fixed bugs in many elements, including ToDump and FromLinux.

** Classifier optimization is now iterative, not recursive, which gets
   around problems with small kernel stacks.

** Removed 'PACKETS' or 'BYTES' argument to Counter. Now it always keeps
   track of both number of packets and number of bytes. Also added several
   LLRPCs.

* Kernel driver

** Added patch for 2.2.18 kernel.

** Changed /proc/click file handling: Now closing a write handler file may
   report an error back to the user through the return value of close().
   Also, can remove Click kernel module even while someone has a file in
   /proc/click open.

** Added TulipStats element for collecting information about Tulip
   performance.

** Replaced old cycle-counting elements with SetCycleCount and
   CycleCountAccum, and similarly for performance counter elements (new
   elements are SetPerfCount and PerfCountAccum).

** Fixed crash when Linux and Click both sent packets out the same
   interface on an SMP machine.


Version 1.1b1   4.Oct.2000

* Incompatible element changes

** Added support for parsing CIDR-style [Classless Inter-Domain Routing]
   netmasks in element configuration strings. Old-style netmasks are still
   supported, but you must use a slash, not a space. So for the 18.26.7
   IP prefix, you can write either `18.26.7.0/255.255.255.0' or
   `18.26.7.0/24'. You will need to change the arguments to any
   ARPResponder, FromLinux, LookupIPRoute, LookupIPRoute2, and RIPSend
   elements in your configuration files.

** Deprecated FromBPF and ToBPF in favor of FromDevice and ToDevice. (But
   the arguments to FromDevice and ToDevice are the same as FromBPF and
   ToBPF.)

** The KernelTap element (formerly Tun) no longer takes a device name as
   the first argument; it chooses between /dev/tun and /dev/tap
   automatically. KernelTap also expects and produces ethernet-encapsulated
   packets (rather than IP), as the Ethernet type field lets it handle IPv6
   packets as well as IPv4.

** Changed the third argument to RatedSource. Used to be a duration to send
   packets; now it is the number of packets to send.

** The following elements have been renamed.

	OLD			NEW
	------------------	------------------
	CheckPaint*		PaintTee
	FromBPF			FromDevice
	HashDemux*		HashSwitch
	Meter			BandwidthMeter
	PacketMeter		Meter
	PacketShaper		Shaper
	PullToPush*		Unqueue
	SetIPAddress+		StoreIPAddress
	Shaper			BandwidthShaper
	ToBPF			ToDevice
	Tun			KernelTap

   * Old element name may still be used for this release, but is
     deprecated.
   + A new element has taken the name SetIPAddress.

   Our apologies. We don't expect this kind of renaming will be a common
   event.

** To reiterate, the elements that measure bytes per second are now named
   BandwidthMeter and BandwidthShaper. The elements that measure packets
   per second have taken the names Meter and Shaper.

** Removed the SaveIPFields and IPsec elements (they were rotting).

* Incompatible C++ API changes

** Reorganized Linux kernel polling patches. If you have a previous version
   of Click, you must unapply the old kernel patch and apply the new kernel
   patch before compiling.

** Improved Packet copy-on-write behavior by reflecting it in the C++ class
   structure. Now there is a class for possibly-shared packets (named
   Packet), and a class for definitely-not-shared packets (named
   WritablePacket). WritablePacket is a subclass of Packet. Packet's data
   is always read-only (that is, the `data()' method returns a `const
   unsigned char *', and so forth). WritablePacket's data is read/write
   (the `data()' method returns an `unsigned char *').
   `Packet::uniqueify()' and similar methods return a WritablePacket.

** Made configuration argument parsing more uniform among elements. For
   example, every configuration argument is always a comma-separated
   string. This is enforced by passing a vector of strings to the
   `configure' method: `cp_argvec' is called before the `configure' method
   is called. Changed Element method `int configure(const String &,
   ErrorHandler *)' to `int configure(const Vector<String> &, ErrorHandler
   *)', and updated elements.

** The `cp_DATATYPE' functions take pointers instead of references. This
   makes their use easier to read.

** The `cp_DATATYPE' functions no longer take an optional `String *rest'
   argument. They always parse their argument string entirely.

** Changed Element method `bool configure_first() const' to `int
   configure_phase() const'. Now element classes can specify their relative
   configuration and initialization order; for example, ToDevice specifies
   that it should be configured and initialized after any FromDevices.

** Removed user-level Element method `select_fd()'. Replaced with
   `add_select(fd, mask)' and `remove_select(fd, mask)', so elements can
   listen to any number of file descriptors for reading, writing, or both.
   (`mask' is either `SELECT_READ', `SELECT_WRITE', or
   `SELECT_READ|SELECT_WRITE'.)

** Other small changes and method renamings should have limited impact. For
   instance, renamed `Element::number()' to `Element::eindex()'; removed
   `Element::use()' and `Element::unuse()'; renamed
   `Element::change_configuration()' to `Element::set_configuration()' and
   `Element::set_configuration_argument()'.

** Renamed Ethernet and ARP structures; what was `struct ether_header' is
   now `struct click_ether', and so forth, to avoid conflicts.

** Removed `IPVERSION' constant from `click_ip.h' to support IPv6.

* General

** Added new `tickets' and `handlers' handlers, available by default on
   every element. Removed default `inputs' and `outputs' handlers,
   replacing them with `ports'.

** Improved support for large numbers of handlers by reducing memory usage.

** Click configurations can contain cpp(1)-style `#line LINENUMBER' or `#
   LINENUMBER' directives. The tools generate them, too, so you will get
   better error messages than before.

** Improved element documentation by adding summaries. The generated
   elements(n) manual page now groups the elements by function. Also
   updated and documented the format for doc comments (see
   `doc/elementdoc.7').

** Added low-level RPC capability. LLRPCs are low-level handlers designed
   for speed rather than ease of use or human-readable results. In the
   Linux kernel module, LLRPCs are called in response to ioctl(2) commands
   on handler files. (The user-level program doesn't support LLRPCs yet.)
   Unlike handlers, LLRPCs can both take arguments and return results.
   IPRateMonitor(n), for example, uses LLRPCs to report rate information.

** Lexer changes: Now single and double quotes are interpreted in
   configuration arguments vaguely as in Perl. Configuration argument
   parsing is generally more regular.

** Fixed bugs in real-number parsing and unparsing functions.

* User-level driver

** User-level Click will no longer stop by default when an InfiniteSource
   (or RatedSource or FromDump) runs out of packets to send. Supply the
   `-s' option to get the old behavior.

** You can give shell globbing syntax to the user-level driver's `-h
   HANDLER' option; for example, `-h "*.config"'.
 
** Fixed FromBPF and ToBPF, finally. The fixed versions are called
   FromDevice and ToDevice.

** Added ControlSocket element so you can call handlers from other
   programs.

* Kernel driver

** Added patch for Linux kernel 2.2.16. This patch contains the latest
   changes to Linux. While Click will continue to work under 2.2.14 for the
   time being, it may not work in the future. If you have a previous
   version of Click, you must unapply the old kernel patch and apply the
   new kernel patch before compiling.

** Improved /proc handling. It is now safe to keep open file descriptors to
   handler files even while uninstalling the kernel module or installing a
   new configuration. These files will become unusable after the
   (un)installation -- every operation will return EINVAL -- but the kernel
   will not crash and the Click module's reference count will not get
   screwed up.

** Cleaned up polling interface in Linux.

* Elements

** Added QuitWatcher, FrontDropQueue, StripIPHeader, IPClassifier,
   IPFilter, IPPrint, FTPPortMapper, IPRewriterPatterns, Switch,
   PullSwitch, StaticSwitch, StaticPullSwitch, RoundRobinSwitch,
   StrideSwitch, RatedSplitter, BandwidthRatedSplitter, RatedUnqueue, and
   BandwidthRatedUnqueue, among others. Also mentioned above: user-level
   FromDevice, ToDevice, and ControlSocket; kernel module ToLinuxSniffers;
   generic SetIPAddress, StoreIPAddress.

** Added AddressInfo element, which supports network address mnemonics. For
   example, you can now say `AddressInfo(butt 18.26.4.44); IPEncap(6, butt,
   18.26.4.15)'. The `butt' in IPEncap's configuration string then means
   `18.26.4.44'.

** Added experimental IPv6 elements; `./configure --enable-ip6' to compile
   them.

** Fixed kernel alignment bug in IP header checking elements: can't use
   Linux's `fast_ip_csum' on unaligned data.

** Fixed user-level FromDevice and ToDevice bugs. Now FromDevice will not
   starve other router processing, and ToDevice works on Linux.

** Fixed FromLinux bug: now supports multiple instances of FromLinux for same
   device (this happens while installing a new configuration: initialize is
   called on the new FromLinux before the last FromLinux instance is
   uninitialized).

** Fixed ToLinux: now calls ptype_dispatch inside start_bh_atomic() and
   end_bh_atomic().

** Modified kernel ToDevice: ToDevice now sends Linux's packets when the
   device is idle. This prevents Click from starving out packets sent by
   other processes or Linux.

** Shaper and BandwidthShaper work significantly better. They are less
   bursty and can correctly shape traffic to low rates. 

** Improved Classifier optimizations.

** Radio elements are not compiled by default.

** Added new `elements/local' directory for your own elements. They are not
   compiled by default.

* Tools

** Added new click-undead(1) tool.

** Fixed click-uncombine(1) bugs and changed its order of arguments.

** Added PollDevice and EtherEncap specifications to click-align(1).

** click-fastclassifier(1) works on IPClassifier and IPFilter.

** Added `--verbose' option to click-install(1).


Version 1.0.6   6.May.2000

* Kernel driver

** Fixed kernel Packet::expensive_push. Patch by Richard Mortier
   <rmm1002@cam.ac.uk>.

** Added /proc/click/version.

* Elements

** Replace UDPEncap with UDPIPEncap. New element adds both IP and UDP
   headers, and fixes several bugs in UDPEncap. Thanks to Richard Mortier
   <Richard.Mortier@cl.cam.ac.uk>.

* Miscellaneous

** Fixed findelements.sh: Ethernet switch elements were not being included.


Version 1.0.5   1.May.2000

* Kernel and user-level drivers

** You can hot-swap install Click configurations in the Linux kernel
   module. In a hot-swap install, packets stored in the old configuration
   will not be lost. (The new configuration's Queues must have the same
   names as the old configuration's Queues.) See the click.o(8) man page
   (under /proc/click/hotconfig) and the click-install(1) man page for more
   information.

** Bug fixes: User-level Click correctly handles timed elements like
   TimedSource and TimedSink and scheduled elements like RatedSource; and
   the kernel module correctly handles timed elements. Reported by Saurabh
   Sandhir <sandhir@purdue.edu>.

** More changes to ToDevice to enable Linux and Click to send packets
   independently and not cause race conditions. This includes a new linux
   kernel patch (etc/linux-2.2.14-patch) and changes to ToDevice. Click
   runs in a separate kernel thread, so we synchronize ToDevice send
   operations in kernel with a bit lock (dev->tbusy).

** Every Linux kernel module now runs as a separate kernel thread, even if
   HAVE_POLLING is not defined.

** The click user-level driver can now automatically compile any required
   package sources. (Click-install has been able to do this for a while.)

** Every router has its own list of Timers, so Timer has no global state.
   Originally requested by Leigh Stoller <stoller@fast.cs.utah.edu>. This
   changed the Timer abstraction; you now need to call Timer::attach() on a
   Timer before using it. See timedsource.cc for an example.

** Fixed bugs and memory leaks.

* Tools

** click-xform: Bug fixes and performance improvements. Also, click-xform
   tries to preserve element names from the original configuration. If a
   pattern element and a replacement element share a name, then when the
   pattern is applied, the replacing element will use the name of the
   original element that corresponded to the pattern element. (Phew!)

** click-devirtualize: Bug fixes. It also uses standards-compliant C++.

** click-fastclassifier can combine adjacent Classifiers.

** Added click-combine and click-uncombine.

* Elements

** Removed UnlimitedElement in favor of `notify_n{in,out}puts()'.

** Removed TimedElement.

** Removed Broadcast in favor of Tee.

** Added select_fd() and selected() to ToBPF.

** Various other fixes.

* Configurations

** Added conf/make-udpgen.pl, a Perl script that generates a udpgen-like
   Click configuration.

** Added conf/make-udpcount.pl, a Perl script that generates a
   udpcount-like Click configuration.


Version 1.0.4   13.Apr.2000 (not released)

* Changed how FromDevice, ToDevice, and PollDevice interact with each
  other. Before, if you specify just PollDevice w/o ToDevice, the tx queue
  does not get cleaned because in polling mode tx queue cleaning must be
  scheduled explicitly. Now, PollDevice looks for a ToDevice on the same
  device. If no such element exists, it remembers to clean the tx queue
  itself. Also ToDevice looks for a PollDevice to decide if it should use
  polling extensions. Some of this code was in the 1.0.3 release, but there
  was a bug.

* New linux kernel patch (etc/linux-2.2.14-patch): locks are added to protect
  recycling of sk_buff objects and device polling functions - not extensively
  tested.

* New elements: UDPEncap (put an UDP header on a packet), RatedSource (like
  infinite source, but send packets at a given rate).

* udpgen click configuration (conf/udpgen.click): This is better than
  udpgen.o in that you can utilize device driver polling extensions. Also,
  on some machines we observe a delay (on order of ms) between when
  transmission complete and tx interrupt. This causes the transmission
  queue to not get cleaned fast enough for udpgen to send its packets.
  Using Click, we can control when the tx queue is cleaned.


Version 1.0.3   9.Apr.2000

* Added `--with-linux[=DIR]' option to `./configure'. Suggested by Richard
  Mortier <Richard.Mortier@cl.cam.ac.uk>.

* Removed `default_processing()' method of Element and replaced it with
  `processing()'. Where you once wrote `Processing default_processing()
  const { return PUSH; }', now write `const char *processing() const {
  return PUSH; }'. The new way is more flexible and lets us abstract the
  element's processing code. See Element(3) for details.

* Added `click-check' tool, a static checker for Click configurations.
  Currently it only checks push and pull processing for correctness.

* Added `--reverse' option to click-xform. Suggested by Mike Burrows
  (Compaq SRC).

* Added `--reverse' options to click-fastclassifier and click-devirtualize.

* Renamed click-specialize tool to click-devirtualize. It's clearer. Also
  fixed several bugs.

* Click-devirtualize now determines automatically whether two specialized
  elements can share code. As a result, the `--like' option has been
  removed.

* Fixed bugs: RFC2507Decomp didn't compile. Rewriter updates. Several bugs
  caught by recent GCCs; patches supplied by Richard Mortier
  <Richard.Mortier@cl.cam.ac.uk>.


Version 1.0.2   20.Mar.2000

* Fixed reentrancy bug: in this release, when running in polling mode in
  kernel, timers are maintained by click, in the same fashion userlevel timers
  are maintained. Previously, we use linux timers, and so callbacks may get
  called by linux when click is running, creating possible race conditions.
  Note: in polling mode, if the click thread yields to other processes, timers
  will not get called until the click thread runs again.

* Added Rewriter, MappingCreator, and IPMirror elements for rewriting
  TCP/IP and UDP/IP streams.

* Added MarkIPHeader, CheckTCPHeader, and CheckUDPHeader elements.

* Fixed FromDump and ToDump.

* Added optional queue names to RED.

* Removed `is_a()' and `is_a_cast()' methods of Element. The new way,
  `cast()', allows arbitrary interfaces.

* Use Linux's fast checksum routines in CheckIPHeader and IPInputCombo.

* Fixed bug in userlevel Click: elements weren't being scheduled, so
  nothing seemed to happen.


Version 1.0.1   28.Feb.2000

* Fixed Makefile bugs; Linux module installs properly now. Problem reported
  by Joe Elliott <joe@inetd.com>.


Version 1.0   25.Feb.2000

* Added polling support. Result: 4-5 times better peak performance. The
  optimization tools can get it up to 6 times better (435,000 64-byte
  packets per second).

* Replaced work list with stride scheduler.

* In the Linux kernel, Click now runs in a kernel thread.

* Removed packet-upstream events and the associated processing in Queue,
  Shaper, and so forth. The stride scheduler solves the same problem more
  elegantly.

* Added `click-specialize' tool.

* Added `click-uninstall' tool.

* Added dynamic IP routing table element (LookupIPRoute2).

* Added stride scheduling packet scheduler element (StrideSched).

* Added PeekHandlers and PokeHandlers elements so you can test read and
  write handlers at user level.

* Fixed lexer bug: compound elements with `{' are accepted everywhere.

* Added arguments to compound elements.

* Rearranged directory structure. (Include files placed in
  PREFIX/include/click, not directly in PREFIX/include.)

* Improved several elements, including ARPQuerier.

* Changed interface for registering handlers. See
  `elements/standard/red.cc' or the Element(3) manual page for examples.

* Many other changes, bug fixes and improvements.


Version 0.6   11.Dec.1999

* Added dynamic linking support. Click configuration files can now be ar(1)
  archives, possibly containing "packages"---dynamically linked object
  files that are loaded into the kernel module or the user-level program.
  This means you can make your own element classes and link them
  dynamically.

* Added `click-fastclassifier' and `click-install' tools.

* Added `--help', `--version', etc. options to tools.

* Added man pages for `click', `click-align', and `click-install'.

* More options for user-level Click, including support for hander
  invocations on the command line.

* Added `udpgen' and `udpcount' in the `tools' directory.

* Fixed dynamic reconfiguration bug: no more doubled characters.

* Fixed compound element bug: input and output ports bigger than 0 were
  ignored.


Version 0.51   12.Nov.1999

* Support for required-alignment machines via `click-align' tool. Added
  click-align tool, Align and AlignmentInfo elements.

* More documentation.


Version 0.5   20.Oct.1999

* First public release.
