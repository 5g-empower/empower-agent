SHELL = @SHELL@
@SUBMAKE@

top_srcdir = @top_srcdir@
srcdir = @srcdir@
top_builddir = ../..
subdir = tools/lib
conf_auxdir = @conf_auxdir@

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
libdir = @libdir@
includedir = @includedir@/click
HOST_TOOLS = @HOST_TOOLS@

VPATH = .:$(top_srcdir)/$(subdir):$(top_srcdir)/tools/lib:$(top_srcdir)/lib

CC = @CC@
CXX = @CXX@
AR = @AR@
RANLIB = @RANLIB@
HOST_CC = @HOST_CC@
HOST_CXX = @HOST_CXX@
HOST_AR = @HOST_AR@
HOST_RANLIB = @HOST_RANLIB@
INSTALL = @INSTALL@
INSTALL_DATA = @INSTALL@ -m 644
INSTALL_DATA_IF_CHANGED = @INSTALL_IF_CHANGED@ -m 644
mkinstalldirs = $(conf_auxdir)/mkinstalldirs

.SUFFIXES:
.SUFFIXES: .S .c .cc .o .ho .s

.c.o:
	$(COMPILE) -c $<
.s.o:
	$(COMPILE) -c $<
.S.o:
	$(COMPILE) -c $<
.cc.o:
	$(CXXCOMPILE) -c $<
.c.ho:
	$(COMPILE) -c $< -o $@
	@sed 's/\.o:/\.ho:/' < $*.d > $*.hd; /bin/rm -f $*.d
.cc.ho:
	$(CXXCOMPILE) -c $< -o $@
	@sed 's/\.o:/\.ho:/' < $*.d > $*.hd; /bin/rm -f $*.d


OBJS = vectori.o vectorv.o bitvector.o hashmapi.o straccum.o string.o error.o \
	elementt.o routert.o variableenv.o lexert.o packageutils.o \
	confparse.o archive.o processingt.o \
	ipaddress.o ipaddressset.o etheraddress.o \
	userutils.o toolutils.o clp.o @LIBOBJS@ @EXTRA_TOOL_OBJS@
HOSTOBJS = $(patsubst %.o,%.ho,$(OBJS))

CPPFLAGS = @CPPFLAGS@ -MD -DCLICK_TOOL
CFLAGS = @CFLAGS@
CXXFLAGS = @CXXFLAGS@

DEFS = @DEFS@
INCLUDES = -I$(top_builddir)/include -I$(top_srcdir)/include \
	-I$(srcdir)
LDFLAGS = @LDFLAGS@
LIBS = @LIBS@

CXXCOMPILE = $(CXX) $(DEFS) $(INCLUDES) $(CPPFLAGS) $(CXXFLAGS)
COMPILE = $(CC) $(DEFS) $(INCLUDES) $(CPPFLAGS) $(CFLAGS)

ifeq ($(HOST_TOOLS),mixed)
all: libclicktool.a libclicktool_host.a
endif
ifeq ($(HOST_TOOLS),host)
all: libclicktool_host.a
endif
ifeq ($(HOST_TOOLS),target)
all: libclicktool.a
endif

libclicktool.a: Makefile $(OBJS)
	$(AR) cru libclicktool.a $(OBJS)
	$(RANLIB) libclicktool.a
libclicktool_host.a: Makefile $(HOSTOBJS)
	$(HOST_AR) cru libclicktool_host.a $(HOSTOBJS)
	$(HOST_RANLIB) libclicktool_host.a

Makefile: $(srcdir)/Makefile.in
	cd $(top_builddir) \
	  && CONFIG_FILES=$(subdir)/$@ CONFIG_ELEMLISTS=no CONFIG_HEADERS= $(SHELL) ./config.status

DEPFILES := $(wildcard *.d *.hd)
ifneq ($(DEPFILES),)
include $(DEPFILES)
endif

install: libclicktool.a
	$(mkinstalldirs) $(libdir)
	$(INSTALL_DATA) libclicktool.a $(libdir)/libclicktool.a
	$(mkinstalldirs) $(includedir)
	$(INSTALL_DATA_IF_CHANGED) $(srcdir)/*.hh $(includedir)
install-man:

clean:
	rm -f *.d *.hd *.o *.ho libclicktool.a libclicktool_host.a
distclean: clean
	-rm -f Makefile

.PHONY: all clean distclean install install-bin install-man
