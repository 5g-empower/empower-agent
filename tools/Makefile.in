# Warning: this file must be usable by regular make
# (unlike the Makefiles in subdirectories).

SHELL = @SHELL@
@SUBMAKE@

top_srcdir = @top_srcdir@
srcdir = @srcdir@
top_builddir = ..
subdir = tools

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
INSTALL = @INSTALL@
mkinstalldirs = @top_srcdir@/mkinstalldirs

TOOLDIRS = click-align click-fastclassifier click-install click-specialize click-xform
TARGETS = @TOOL_TARGETS@

all: $(TARGETS)

click-align: Makefile
	@cd click-align; $(MAKE) all
click-fastclassifier: Makefile
	@cd click-fastclassifier; $(MAKE) all
click-install: Makefile
	@cd click-install; $(MAKE) all
click-xform: Makefile
	@cd click-xform; $(MAKE) all

Makefile: $(srcdir)/Makefile.in
	cd $(top_builddir) \
	  && CONFIG_FILES=$(subdir)/$@ CONFIG_ELEMLISTS=no CONFIG_HEADERS= $(SHELL) ./config.status

click-compile: $(srcdir)/click-compile.in
	cd $(top_builddir) \
	  && CONFIG_FILES=$(subdir)/$@ CONFIG_ELEMLISTS=no CONFIG_HEADERS= $(SHELL) ./config.status
	@chmod +x click-compile; touch click-compile

clean:
	@-for d in $(TOOLDIRS); do (cd $$d && $(MAKE) clean); done
distclean:
	@-for d in $(TOOLDIRS); do (cd $$d && $(MAKE) distclean); done
	-rm -f Makefile click-compile

install: install-subdirs install-local
install-local: click-compile
	$(mkinstalldirs) $(bindir)
	@chmod +x click-compile
	$(INSTALL) click-compile $(bindir)/click-compile
install-subdirs:
	@for d in $(TARGETS); do (cd $$d 2>/dev/null && $(MAKE) install); done

DISTFILES = Makefile.in \
	lib/elementt.cc lib/elementt.hh \
	lib/lexert.cc lib/lexert.hh \
	lib/routert.cc lib/routert.hh \
	lib/toolutils.cc lib/toolutils.hh \
	lib/hashmapi.cc \
	lib/vectori.cc \
	click-align/Makefile.in \
	click-align/click-align.cc \
	click-align/alignment.cc click-align/alignment.hh \
	click-align/alignclass.cc click-align/alignclass.hh \
	click-compile.in \
	click-fastclassifier/Makefile.in \
	click-fastclassifier/click-fastclassifier.cc \
	click-install/Makefile.in \
	click-install/click-install.cc \
	click-xform/Makefile.in \
	click-xform/click-xform.cc

distdir:
	mkdir $(distdir)
	@-chmod 777 $(distdir)
	@-for d in lib $(TOOLDIRS); do mkdir $(distdir)/$$d; chmod 777 $(distdir)/$$d; done
	@for file in $(DISTFILES); do \
	  d=$(srcdir); \
	  if test -d $$d/$$file; then \
	    cp -pr $$d/$$file $(distdir)/$$file; \
	  else \
	    test -f $(distdir)/$$file \
	    || ln $$d/$$file $(distdir)/$$file 2> /dev/null \
	    || cp -p $$d/$$file $(distdir)/$$file || :; \
	  fi; \
	done


.PHONY: all $(TOOLDIRS) clean distclean distdir install install-man install-subdirs
