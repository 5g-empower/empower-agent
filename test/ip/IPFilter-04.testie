%info

Test IPFilter optimizations.

%script
click SCRIPT -qh '*.program'

%file SCRIPT
i :: Idle;

i -> c :: IPClassifier(dst port 7777, dst port 8888, dst port 7000, icmp type echo, icmp, -) [0,1,2,3,4,5] -> i;

%expect stdout
c.program:
 0 260/00000000%00001fff  yes->step 1  no->step 8
 1 264/00060000%00ff0000  yes->step 3  no->step 2
 2 264/00110000%00ff0000  yes->step 3  no->step 6
 3 512/00001e61%0000ffff  yes->[0]  no->step 4
 4 512/000022b8%0000ffff  yes->[1]  no->step 5
 5 512/00001b58%0000ffff  yes->[2]  no->[5]
 6 264/00010000%00ff0000  yes->step 7  no->[5]
 7 512/08000000%ff000000  yes->[3]  no->[4]
 8 264/00010000%00ff0000  yes->[4]  no->[5]
safe length 516
alignment offset 0

%expect stderr
